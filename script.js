const contents = {
  work: [
   {
  title: "二人展「シャイニンd(^_^o)」",
  details: "私、オオタソラと友人の新の二人展のwebsite。星のグラフィックは新が作成し、それを元にwebsiteのデザインと実装を行った。web上のDMやハガキを目指して作成した。カーソルの位置で影の描写が変わる。展示準備の際にやりとりしたメールなども掲載している。",
  images: ["workimag/shining/shining1.png", "workimag/shining/shining2.png", "workimag/shining/shining3.png"],
  date: "2024",
  category: "website",
  link: "https://otasora.website/shining/"
}
,
      {
  title: "イーソーのタトゥー",
  details: "友人のタトゥーのデザイン。要望の麻雀のイーソーをモチーフにドットのイラストレーションを作成した。",
  images: ["workimag/iso/iso2.jpg", "workimag/iso/iso1.png", "workimag/iso/iso3.png"],
  date: "2023",
  category: "design",
  link: ""
}
,   {
  title: "スポーツデンキデパート 1stEP「電波ステーション」",
  details: "スポーツデンキデパートの1stEP「電波ステーション」のジャケットで使用したイラストレーション。電波っぽく中性的なキャラクターのイラストを作成した。",
  images: ["workimag/dempastation/dempastation1.jpg", "workimag/dempastation/dempastation2.jpg", "workimag/dempastation/dempastation3.jpg", "workimag/dempastation/dempastation4.jpg"],
  date: "2023",
  category: "illustration",
  link: "https://linkco.re/aXHex5Hs/songs/2424992/lyrics?lang=ja"
}
,   {
  title: "小林 玲衣奈 オンライン展示「あわいのために」",
  details: "小林 玲衣奈さんのオンライン展示「あわいのために」のDMとサイトで使用したグラフィックデザイン。オンライン上での展示なので、DMは16:9のサイズで制作。<br>令和5年度文化庁メディア芸術クリエイター育成支援事業採択",
  images: ["workimag/theinbetween/between1.jpg", "workimag/theinbetween/between2.jpg", "workimag/theinbetween/between3.jpg"],
  date: "2023",
  category: "graphic design",
  link: "https://www.kobayashireina.com/theinbetween"
}
,   {
  title: "塩澄 祥大個展「BMX Graffiti」",
  details: "塩澄 祥大さんの個展「BMX Graffiti」のチラシなどのグラフィックデザイン。自転車でストリートにグラフィティした作品の展示で、夜に撮影されていたことから写真の荒さを生かしたて作成した。写真のドットを変形させて独自の荒さを作っている。<br>令和5年度文化庁メディア芸術クリエイター育成支援事業採択",
  images: ["workimag/bmxg/BMXGraffiti.gif", "workimag/bmxg/BMXGraffiti1.jpg", "workimag/bmxg/BMXGraffiti2.jpg", "workimag/bmxg/BMXGraffiti3.jpg", "workimag/bmxg/BMXGraffiti4.jpg", "workimag/bmxg/BMXGraffiti5.jpg", "workimag/bmxg/BMXGraffiti6.jpg", "workimag/bmxg/BMXGraffiti7.jpg", "workimag/bmxg/BMXGraffiti8.jpg"],
  date: "2023",
  category: "graphic design",
  link: "http://blockhouse.jp/index.php?itemid=315"
}
,   {
  title: "植物生体電位測定キット",
  details: "西田騎夕さんの「植物生体電位測定をオープンにするプロジェクト」で作成した測定キットのパッケージデザイン。タイトルとグラフィックのスタンプを数パターンづつ作成し、組み合わせることでバリエーションの展開をしている。グラフィックは葉や電図の波などをモチーフにしている。",
  images: ["workimag/plantkit/plantkit.GIF",  "workimag/plantkit/plantkitp2.jpeg", "workimag/plantkit/plantkitp3.jpeg", "workimag/plantkit/plantkitp4.jpeg", "workimag/plantkit/plantkitp5.jpeg","workimag/plantkit/plantkitp1.jpeg", "workimag/plantkit/plantkitp6.png"],
  date: "2023",
  category: "package design",
  link: "https://booth.pm/ja/items/5136397"
}
,   {
  title: "はじめての植物生体電位測定",
  details: "西田騎夕さんの「植物生体電位測定をオープンにするプロジェクト」で作成した技術書。装丁から表紙のイラスト、写真撮影などトータルでデザインを行った。",
  images: ["workimag/plantbook/plantbook1.jpeg", "workimag/plantbook/plantbook2.jpeg","workimag/plantbook/plantbook3.jpeg","workimag/plantbook/plantbook4.jpeg","workimag/plantbook/plantbook5.jpeg","workimag/plantbook/plantbook6.jpeg"],
  date: "2023",
  category: "book/illustration",
  link: "https://booth.pm/ja/items/5136375"
}
,   {
  title: "個人メモサイト　発光！",
  details: "iPhoneのメモアプリに個人的に書き溜めているメモを載せるサイト。ツイッターが名称変更された時に、もっと閉じた場所で呟きとも違うメモを貯める個人的な場所を作れないかと思ったのが動機。既存のブログを更新することと違って、サイトそのものを維持するということを行なっている。右上の色のついた四角を押すとcssが切り替わってデザインが変わる。",
  images: ["workimag/hakko/hakko1.png", "workimag/hakko/hakko2.png", "workimag/hakko/hakko3.png"],
  date: "2023",
  category: "website",
  link: "https://otasora.website/hakko/"
}
,   {
  title: "iamas2023",
  details: "iamasという大学院の修了制作展のグラフィックデザインなどのトータルのデザインを行った。3Dソフト上で2Dのオブジェクトを配置して、空間内をカメラで撮影することでグラフィックに展開している。カメラワークによってバリエーションを作っている。",
  images: ["workimag/iamas2023/iamas2023_2.PNG", "workimag/iamas2023/iamas2023_1.PNG", "workimag/iamas2023/iamas2023_3.PNG", "workimag/iamas2023/iamas2023_4.PNG", "workimag/iamas2023/iamas2023_5.PNG", "workimag/iamas2023/iamas2023_6.PNG", "workimag/iamas2023/iamas2023_7.PNG", "workimag/iamas2023/iamas2023web1.png", "workimag/iamas2023/iamas2023web2.png", "workimag/iamas2023/iamas2023web3.png"],
  date: "2023",
  category: "design/website",
  link: "https://www.iamas.ac.jp/exhibit23/"
}
,   {
  title: "クラブトレイン2022",
  details: "岐阜の樽見鉄道で開催されたクラブイベントのベインビジュアルで使用したイラストレーション。鉄道の車両を貸し切って行うイベントで、地獄行きというコンセプトに合わせて妖怪や骸骨といったモチーフを用いた。",
  images: ["workimag/clubtrain2022/ct1.png", "workimag/clubtrain2022/ct2.JPG", "workimag/clubtrain2022/ct3.jpg"],
  date: "2022",
  category: "illustration",
  link: "https://nxpclab.info/clubtrain2022/"
}
,   {
  title: "基礎デザイン学科卒業制作アーカイブ2021",
  details: "武蔵野美術大学 基礎デザイン学科の2021年度の卒業制作を個人的にまとめたwebsite。同級生や講師の先生に依頼して作品とテキストの掲載を行った。自身の卒業した年度の友人たちの作品や雰囲気をアーカイブしたいという動機から作成した。ほとんど初めて作ったwebsite。",
  images: ["workimag/kisode2021doujin/kisoded2021_1.png", "workimag/kisode2021doujin/kisoded2021_2.png", "workimag/kisode2021doujin/kisoded2021_3.png", "workimag/kisode2021doujin/kisoded2021_4.png", "workimag/kisode2021doujin/kisoded2021_5.png"],
  date: "2022",
  category: "website/edit",
  link: "https://otasora.website/kisodesostuseidoujinshi2021/"
}
,   {
  title: "大きな服小さな家展",
  details: "学部三年生の「展示のデザイン」という授業で作成したグラフィック。大きな服と小さな家をテーマにファッションデザイナーに家を、建築家に服を作ってもらう展示を想定して企画から展示を計画した。",
  images: ["workimag/graphic/exhibitiondesign1.jpg", "workimag/graphic/exhibitiondesign2.jpg", "workimag/graphic/exhibitiondesign3.jpg", "workimag/graphic/exhibitiondesign4.jpg", "workimag/graphic/exhibitiondesign5.jpg", "workimag/graphic/exhibitiondesign6.jpg"],
  date: "2020",
  category: "graphic design",
  link: ""
}
,   {
  title: "食べるグラフィック展",
  details: "2019年の武蔵野美術大学オープンキャンパス内で行った展示。架空のデザイナーを100人設定して、食べ物をテーマにポスターを制作した。三人で行い一人33枚のポスターを制作した。",
  images: ["workimag/eatgraphic/eatgraphic1.jpg", "workimag/eatgraphic/eatgraphic2.jpg", "workimag/eatgraphic/eatgraphic3.jpg", "workimag/eatgraphic/eatgraphic4.jpg", "workimag/eatgraphic/eatgraphic5.jpg"],
  date: "2019",
  category: "exhibition design",
  link: ""
}
,   {
  title: "form/fetishism",
  details: "授業課題で形のフェティシズムをテーマに制作したグラフィック（ポスター）。団地にあるマンションの形をテーマに行った。",
  images: ["workimag/graphic/fetishism.png"],
  date: "2018",
  category: "graphic design",
  link: ""
}
,   {
  title: "judge展",
  details: "2018年の武蔵野美術大学オープンキャンパス内で行った展示。学生による広告ポスターコンペティション。設定した課題に対して広告を制作し、芸祭に遊びに来るお客さんに投票してもらう観客参加型の展示。ニベアクリーム、ステッドラー、チロルチョコなどをテーマに雑誌広告や電車のつり広告といった複数の媒体での広告のデザインを参加者に作成してもらった。本展示の運営を行った。",
  images: ["workimag/jadge/judge1.jpg", "workimag/jadge/judge2.jpg", "workimag/jadge/judge3.jpg", "workimag/jadge/judge4.jpg", "workimag/jadge/judge5.jpg", "workimag/jadge/judge6.jpg", "workimag/jadge/judge7.jpg", "workimag/jadge/judge8.jpg", "workimag/jadge/judge9.jpg", "workimag/jadge/judge10.jpg"],
  date: "2018",
  category: "exhibition design",
  link: ""
}

  ],
  about: [
    {
      title: "about",
      details: "オオタソラ<br>1998年福岡生まれ。武蔵野美術大学 造形学部 基礎デザイン学科 卒業。web、グラフィックデザイン、映像の制作を主に行う。モニターに映し出される表現に興味がある。<br><br>【展覧会歴】<br>2024年 <br>・多摩美術大学助手展2024<br>・2人展「Shinin d(^_^o)」<br>2023年 <br>・多摩美術大学助手展2023",
      images: ["icon.webp"]
    }
  ],
  link_list: [
    {
    title: "link_list",
    details: "",
    images: [""],
    links: [
      { title: "Instagram", url: "https://www.instagram.com/abbbbbbbbboe/" },
      { title: "メモ", url: "https://otasora.website/hakko/" },
      { title: "日記", url: "https://note.com/otasora" }
    ]
  }
  ],
  contact: [
    {
      title: "お問い合わせ",
      details: "メール：ootaoota0038[a]gmail.com<br><br>[a]を@に変更してお使いください。",
      images: []
    }
  ]
};

let selectedDetailIndex = null;
let selectedDetailCategory = null;

function showCategory(category) {
  // 左メニューの選択状態を更新
  document.querySelectorAll('.menu-item').forEach(item => {
    item.classList.remove('active');
    if (item.textContent.trim().toLowerCase() === category) {
      item.classList.add('active');
    }
  });

  const container = document.querySelector('.container');
  const contentList = document.getElementById('content-list');
  const detailsDiv = document.getElementById('details');
  contentList.innerHTML = '';
  detailsDiv.innerHTML = `
  <div id="preview-item"></div>
  <div id="detail-item"></div>
`;


  selectedDetailIndex = null;
  selectedDetailCategory = null;

 if (category === 'about' || category === 'contact' || category === 'link_list') {
  const item = contents[category][0];

  let html = `
    <p>${item.title}</p>
    <p>${item.details}</p>
  `;

  // 🔽リンクがあれば中央エリアに表示
  if (item.links && item.links.length > 0) {
   const linkListHTML = `
    <div class="links">
      ${item.links.map(link =>
        `<p><a href="${link.url}" target="_blank" rel="noopener noreferrer">${link.title}</a></p>`
      ).join('')}
    </div>
  `;
    html += linkListHTML;
  }

  contentList.innerHTML = html;

  // 画像があれば右側（detailsDiv）に表示
  let imagesHTML = '';
  if (item.images && item.images.length > 0) {
    imagesHTML = item.images.map(src => `<img src="${src}" class="about-image">`).join('');
    detailsDiv.innerHTML = imagesHTML;
  } else {
    detailsDiv.innerHTML = ''; // 画像がなければ空に
  }

  } else {
    contentList.innerHTML = `<p>${category}</p>`;

    contents[category].forEach((item, index) => {
  const div = document.createElement('div');
  div.className = 'content-item';



  // タイトル + 日付・カテゴリをHTMLとして組み立て
  div.innerHTML = `
    <strong>${item.title}</strong><br>
    ${item.date ? `<small>${item.category}</small>` : ''}
    ${item.category ? `<small>${item.date}</small>` : ''}
  `;

  div.onclick = () => showDetails(category, index);

 const previewDiv = document.getElementById("preview-item");

div.onmouseenter = () => {
  if (selectedDetailIndex === index && selectedDetailCategory === category) return;

  const previewImage = item.images && item.images[0];
  const previewDiv = document.getElementById("preview-item");

  if (previewImage) {
    previewDiv.innerHTML = `
      <img src="${previewImage}" style="
       width: 100%;
    height: 100%;
    object-fit: contain;
    display: block;
      ">
    `;
    previewDiv.style.display = "block";
  }
};

div.onmouseleave = () => {
  const previewDiv = document.getElementById("preview-item");
  previewDiv.innerHTML = '';
  previewDiv.style.display = "none";
};


  contentList.appendChild(div);
});

  }

  addToHistory({ type: 'category', category });

  if (window.innerWidth <= 768) {
    container.classList.remove('show-detail');
    container.classList.remove('show-menu');
    container.classList.add('show-list'); // 中央パネルに進む
    window.scrollTo(0, 0);
  }
}

function showDetails(category, index) {
  const container = document.querySelector('.container');
 
 const previewDiv = document.getElementById('preview-item');
if (previewDiv) previewDiv.innerHTML = '';

 const detail = contents[category][index];
  const detailDiv = document.getElementById('detail-item');
  detailDiv.scrollTop = 0; 
 // ←ここ修正

  document.querySelectorAll('.content-item').forEach(item => {
    item.classList.remove('active');
  });
  const selectedItem = document.querySelectorAll('.content-item')[index];
  if (selectedItem) selectedItem.classList.add('active');

  let imagesHTML = "";
  if (detail.images && detail.images.length > 0) {
    imagesHTML = detail.images.map((src, idx) => {
      const className = idx === 0 ? "detail-image-large" : "detail-image-half";
      return `<img src="${src}" class="${className}">`;
    }).join('');
  }

  // detailDiv に詳細を書き込む
  detailDiv.innerHTML = `
    <p class="detail-title">${detail.title}</p>
    <p class="detail-meta">
      ${detail.date ? `<span class="detail-date"> ${detail.date}</span><br>` : ''}
      ${detail.category ? `<span class="detail-category"> ${detail.category}</span><br>` : ''}
      ${detail.link ? `<span class="detail-link"><a href="${detail.link}" target="_blank">${detail.link}↗︎</a></span><br>` : ''}
    </p>
    <p class="detail-description">${detail.details}</p>
    <div class="detail-images">${imagesHTML}</div>
  `;

  selectedDetailCategory = category;
  selectedDetailIndex = index;

  addToHistory({ type: 'detail', category, index });

  if (window.innerWidth <= 768) {
    container.classList.remove('show-menu');
    container.classList.remove('show-list');
    container.classList.add('show-detail');
    window.scrollTo(0, 0);
  }
}


window.addEventListener("load", () => {
  preloadImages(bgImages); // 画像プリロード（任意）

  showCurrentBackground();
  
function preloadImages(images) {
  images.forEach(src => {
    const img = new Image();
    img.src = `backgroundimag/${src}`;
  });
}

  const menuItems = document.querySelectorAll(".menu-item");
  menuItems.forEach(item => {
    item.addEventListener("click", () => {
      advanceBackground();
    });
  });

  const parent = document.getElementById("content-list");
  if (parent) {
    parent.addEventListener("click", (e) => {
      if (e.target.classList.contains("content-item") || e.target.closest(".content-item")) {
        advanceBackground();
      }
    });
  }
});



const bgImages = [
  "bg1.png", "bg2.png", "bg3.png", "bg4.png", "bg5.png",
  "bg6.png", "bg7.png", "bg8.png", "bg9.png", "bg10.png",
  "bg11.png", "bg12.png", "bg13.png", "bg14.png", "bg15.png",
  "bg16.png", "bg17.png", "bg18.png", "bg19.png", "bg20.png",
  "bg21.png", "bg22.png", "bg23.png", "bg24.png", "bg25.png",
  "bg26.png", "bg27.png"
];

function preloadImages(images) {
  images.forEach(src => {
    const img = new Image();
    img.src = `backgroundimag/${src}`;
  });
}

function showCurrentBackground() {
  const detailsDiv = document.getElementById("details");
  let currentIndex = localStorage.getItem("bgIndex");
  if (currentIndex === null) currentIndex = 0;
  else currentIndex = parseInt(currentIndex, 10);

  detailsDiv.style.backgroundImage = `url(backgroundimag/${bgImages[currentIndex]})`;
  detailsDiv.style.backgroundSize = "50px";
  detailsDiv.style.backgroundRepeat = "repeat";
}

function advanceBackground() {
  let currentIndex = localStorage.getItem("bgIndex");
  if (currentIndex === null) currentIndex = 0;
  else currentIndex = parseInt(currentIndex, 10);

  currentIndex = (currentIndex + 1) % bgImages.length;
  localStorage.setItem("bgIndex", currentIndex);

  showCurrentBackground();
}










// 履歴保持

const history = [];

function addToHistory(entry) {
  if (history[0] && JSON.stringify(history[0]) === JSON.stringify(entry)) return;

  history.unshift(entry);
  if (history.length > 10) history.pop();

  const historyBar = document.getElementById('history-bar');
  historyBar.innerHTML = '';

  history.forEach(h => {
    const item = document.createElement('div');
    item.className = 'history-item';

    if (h.type === 'category') {
      item.textContent = `${h.category}`;
      item.onclick = () => showCategory(h.category);
    } else if (h.type === 'detail') {
      const d = contents[h.category][h.index];
      item.textContent = d.title;
      item.onclick = () => showDetails(h.category, h.index);
    }

    historyBar.appendChild(item);
  });
}




const hamburger = document.getElementById('hamburger');
const mobileMenu = document.getElementById('mobile-menu');

hamburger.onclick = () => {
  const isOpen = mobileMenu.style.display === 'flex';

  if (isOpen) {
    mobileMenu.style.display = 'none';
    hamburger.classList.remove('open');
  } else {
    mobileMenu.style.display = 'flex';
    hamburger.classList.add('open');
  }
};

// メニュー項目を選択したらメニューを閉じるようにする
document.querySelectorAll('#mobile-menu .menu-item').forEach(item => {
  item.addEventListener('click', () => {
    mobileMenu.style.display = 'none';
    hamburger.classList.remove('open'); // ついでに ☰ に戻す
  });
});


// メニュー外をクリックしたら閉じる
document.addEventListener('click', (event) => {
  const isClickInsideMenu = mobileMenu.contains(event.target);
  const isClickOnHamburger = hamburger.contains(event.target);

  if (!isClickInsideMenu && !isClickOnHamburger) {
    mobileMenu.style.display = 'none';
    hamburger.classList.remove('open'); // ×マークを戻す
  }
});


